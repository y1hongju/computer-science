# Ch 01. Data Modeling and Design

## 1. 데이터 모델링

> 출처: [데이터 모델링이란 무엇인가요? by AWS](https://aws.amazon.com/ko/what-is/data-modeling/)

### 1-1. 데이터 모델링이란?

- 기업과 같은 조직의 **정보 수집**과 **관리 시스템**을 정의하는 시각적 표현 또는 청사진을 생성하는 일
- 생성된 청사진(데이터 모델)은 데이터 분석가, 사이언티스트, 엔지니어 등 다양한 이해관계자들이 **조직의 데이터에 대한 통일된 개념**을 형성할 수 있도록 도움
- 데이터 모델은 **비즈니스**와 같은 **조직에서 수행하는 어떠한 작업**이 수집하는 데이터, 서로 다른 데이터 세트 간의 **관계**, 데이터를 효율적으로 **저장하고 분석**하는 데 사용되는 **방식**을 설명

### 1-2. 데이터 모델링이 중요한 이유 $\rightarrow$ 왜 하는가?

- 오늘날의 조직은 다양한 소스(원천)에서 많은 양의 데이터를 수집함
- 그러나 원시 데이터만으로는 조직의 니즈가 충족되지 않으며 이 문제를 해결하는 데 도움이 됨
  - e.g., 기업에서는 수익성이 있는 비즈니스 결정을 내리는 데 도움이 됨과 동시에 **실행 가능한 인사이트**를 얻기 위해서는 데이터를 **분석해야만** 함
  - 이 데이터 분석을 **정확하게** 하기 위해서는 효율적인 데이터의 **수집, 저장 및 처리**가 필요
  - 이를 위한 여러 데이터베이스 기술과 데이터 처리 도구가 존재하며 임의의 데이터 세트마다 효율적인 분석을 위한 도구가 상이
- 또한 데이터를 이해하고 이 데이터를 저장하고 관리하기 위한 **적절한 기술의 선택**을 도움
- 건축가가 집을 짓기 전에 청사진을 설계하는 것과 같은 뉘앙스로, 비즈니스 이해관계자는 조직을 위한 데이터베이스 솔루션을 엔지니어링하기 전에 데이터 모델을 설계함

#### 1-2-1. 데이터 모델링의 이점

- **데이터베이스를 활용하는 소프트웨어**를 개발할 때의 오류를 줄일 수 있음
- **데이터베이스 설계 및 생성(구축)** 속도와 효율성이 촉진됨
- 조직 전체에서 **데이터 문서화**와 **시스템 설계**의 일관성을 조성할 수 있음
- **데이터 엔지니어**와 비즈니스 인텔리전스 팀과 같은 **다른 팀** 간의 커뮤니케이션을 촉진시킴

### 1-3. 데이터 모델의 유형

- 데이터 모델링은 **데이터의 개념을 일반화하여 표현**한 다음, **선택한 기술의 맥락에서(해당 기술에 적합하게) 다시 표현**하는 것으로 시작
- 분석가와 이해관계자는 데이터 설계 단계에서 아래와 같은 **다양한 유형의 데이터 모델**을 설계
- [데이터 모델 비교](https://www.1keydata.com/datawarehousing/data-modeling-levels.html)

#### 1-3-1. 개념적 데이터 모델: Conceptual Data Modeling

- 개념적 데이터모델은 조직에서 활용할 데이터에 대한 거시적인 정보를 제공
- e.g., 시스템에 활용되는 데이터
- **데이터 속성** 및 데이터에 대한 **(제약) 조건**
- 데이터와 관련된 비즈니스 규칙
- 효율/효용적인 데이터 **구성 방법**
- 보안 및 데이터 무결성 요구 사항

**분석가와 이해관계자**가 **일반적으로** 만드는 데이터 모델은 **개념적 데이터 모델**이다. 이는 공식적인 데이터 모델링 규칙을 따르지 않고 **간단하게 다이어그램**으로 표현할 수 있다. 공식적인 규칙을 따르지 않더라도 모든(기술적 및 비기술적 이해관계자) 이해관계자가 **데이터에 대한 공통의 이해**를 가지게 되고, 사용되는 데이터의 **목적과 범위 그리고 설계**에 대한 **통일된 개념**을 갖는 일에 개념적 데이터 모델이 도움이 된다는 것이 중요하다.

##### 1-3-1-1. 개념적 데이터 모델의 예시

**자동차 대리점**에 대한 개념적 데이터 모델은 다음과 같은 **데이터 엔터티**로 구성할 수 있다.

- 대리점이 가지고 있는 다양한 **전시장에 대한 정보**를 나타내는 _showrooms_ 엔터티
- 대리점에서 보유하고 있는 다양한 **자동차에 대한 정보**를 나타내는 _cars_ 엔터티
- 대리점에서 자동차를 구매한 **고객에 대한 개인정보** 나타내는 _customers_ 엔터티
- 실제 **판매 이력에 대한 정보**를 나타내는 _sales_ 엔터티
- 대리점에서 일하는 모든 **영업사원에 대한 정보**를 나나태는 _salesperson_ 엔터티

이 개념적 데이터 모델에는 다음과 같은 **비즈니스 요구 사항**이 포함될 수 있다.

- 모든 자동차는 특정 전시장에 속해 **있어야 한다.**
- 모든 판매 이력은 최소 한 명의 영업사원과 한 명의 고객과 연결되어 **있어야 한다.**
- 모든 자동차에는 브랜드 이름과 제품 번호가 **있어야 한다.**
- 모든 고객은 전화번호와 이메일 주소를 가지고 **있어야 한다.**

이에 개념적 데이터 모델은 **비즈니스 규칙**과 **물리적인 데이터베이스 관리 시스템(DBMS)** 간의 다리 역할을 하며, **도메인 모델**이라고 부르기도 한다.

#### 1-3-2. 논리적 데이터 모델: Logical Data Modeling

논리적 데이터 모델은 **개념적 데이터 클래스**를 **기술적 데이터 구조**에 **매핑**하며, 아래와 같은 개념적 데이터 모델에서 식별된 데이터 **개념**과 복잡한 데이터 **관계**에 대한 자세한 내용을 포함한다.

- 다양한 속성에 적용되는 **데이터 타입**: 문자열, 숫자 등
- 데이터 엔터티 간의 **관계**: One-to-one, One-to-many, etc.
- 데이터의 **기본 속성** 또는 **키 필드**: PK, FK 등

**데이터 아키텍트**와 **분석가**는 협업을 통해 논리적 데이터 모델을 만들고, 이를 표현하기 위해 공식적인 데이터 모델링 시스템을 활용한다. 경우에 따라서는 본 단계를 건너 뛰고 개념적 데이터 모델에서 바로 물리적 데이터 모델로 넘어가기도 한다. 다만, 데이터 웨어하우스 같은 **대규모 데이터베이스**와 그것과 연관된 운영 시스템을 설계해야 하는 경우 논리적 데이터 모델링이 유용하게 활용될 수 있기 때문에 다양한 요인을 고려한 합리적인 선택이 요구된다.

##### 1-3-2-1. 논리적 데이터 모델의 예시

**자동차 대리점** 예시에서 설계했던 개념적 데이터 모델을 확장하고 아래와 같이 데이터 클래스를 더 심층적으로 살펴보자.

- _showrooms_ 엔터티에는 **텍스트 형식**의 **이름 필드**, **위치 필드**와 **숫자 형식**의 **전화번호 필드**가 있다.
- _customers_ 엔터티에는 `xxx@example.com` 또는 `xxx.@example.com.yy` 형식의 **이메일 주소 필드**가 있으며, 그 값은 100자 이하여야 한다.
- _sales_ 엔터티에는 **고객 이름 필드**, **판매원 이름 필드**와 **데이트 형식**의 **판매 날짜 필드** 그리고 **10진수 형식**의 **금액 필드**가 있다.

논리적 데이터 모델은 **개념적 데이터 모델**과 개발자가 **데이터베이스를 만드는 데 사용하는 기술** 및 **언어** 사이의 다리 역할을 한다. 다만, 논리적 데이터 모델은 **특정 기술에 종속되지 않으며** 모든 데이터베이스 언어로 구현할 수 있다. 일반적으로 데이터 엔지니어와 이해관계자는 논리적 데이터 모델을 만든 후에 **기술과 관련한 결정**을 내린다.

#### 1-3-3. 물리적 데이터 모델: Pyhsical Data Modeling

물리적 데이터 모델은 논리적 데이터 모델을 **특정(선택된) DBMS에 적합하도록 매핑**하고 해당 소프트웨어와 관련된 용어를 사용하는 단계이다. 물리적 데이터 모델부터는 아래와 같은 세부 정보를 추가적으로 제공할 수 있다.

- DBMS에 표현된 데이터 **필드 유형(타입)**
- DBMS에 표현된 데이터 **관계**
- **성능 최적화**에 필요한 정보 등

데이터 엔지니어는 설계에 대한 기술을 실제로 구현하기 전에 **최종적으로 물리적 데이터 모델을 설계**하며, 설계가 공식적인 데이터 모델링 기술을 준수하고 있는지 확인한다.

##### 1-3-3-1. 물리적 데이터 모델의 예시

자동차 대리점이 [Amazon S3 Glacier Flexible Retrieval](https://aws.amazon.com/s3/storage-classes/)에 데이터 아카이브를 생성한다고 가정할 때, 다음과 같이 모델링을 수행할 수 있다.

- *sales*에서 판매 금액은 `FLOAT` 타입이고, 판매 날짜는 `TIMESTAMP` 타입이다.
- *customer*에서 고객 이름은 `VARCHAR` 타입이다.
- *S3 Glacier Flexible Retrieval*에서 볼트는 데이터의 지리적 위치이다.

물리적 데이터 모델에는 볼트를 생성할 AWS 리전과 같은 **구현을 위한 추가적인 세부 정보**가 포함될 수 있고, **논리적 데이터 모델**과 **최종 기술 구현** 사이의 다리 역할을 한다.

### 1-4. 데이터 모델링 방법론

데이터 모델을 생성하는 데 사용할 수 있는 다양한 **방법과 기법**이 존재한다. 이러한 접근 방법들은 **데이터베이스의 개념**과 **데이터 거버넌스 변화** 등 시대의 흐름에 따라 지속적으로 발전해왔다.

#### 1-4-1. 계층적 데이터 모델링: Hierarchical

다양한 데이터 **요소 간의 관계를 트리 형식**으로 나타내는 기법이다. 루트를 포함한 **상위 데이터 클래스**가 여러 하위 항목에 **매핑되는** **일대다 관계**를 나타내는 것이 특징이다.

자동차 대리점 예시에서는 상위 클래스인 *showrooms*에 *cars*와 _salespeople_ 엔터티가 모두 하위 항목으로 포함될 수 있다. 단일 쇼룸에 여러 대의 자동차와 영업사원이 존재하기 때문이다.

[본 링크](https://media.geeksforgeeks.org/wp-content/uploads/20200727111632/hierarchical.png)는 *전자제품*에 계층적 데이터 모델링을 적용한 예시이다.

#### 1-4-2. 그래프 데이터 모델링: Graph

계층적 데이터 모델링은 데이터베이스 기술의 성숙에 따라 그래프 데이터 모델링으로 발전하였다. 그래프 데이터 모델은 **엔터티의 서열을 동등하게 취급하는** 데이터 관계를 나타낸다. 따라서 엔터티는 상위 또는 하위 개념이 없이 서로 **일대다** 또는 **다대다** 관계를 유지할 수 있다.

자동차 대리점 예시에서는 단일 쇼룸에 여러 명의 영업사원이 있을 수 있고, 한 명의 영업사원이 여러 쇼룸에서 근무하는 경우가 해당한다.

#### 1-4-3. 관계형 데이터 모델링: Relational

관계형 데이터 모델링은 현재 **가장 널리** 사용되는 데이터 모델링 기법 중 하나이다. 데이터 클래스를 **열과 행을 가진 테이블의 형태로 구성 및 시각화**하는 것이 특징이다. 실제 엔터티 간의 관계를 나타내는 **Key** 개념을 사용하여 서로 다른 테이블을 결합하거나 연결하여 사용한다. 관계형 데이터베이스 구조에 **정형 데이터를 저장할 때** 유용한 방법이다.

자동차 대리점 예시에서는 다음과 같이 _salespeople_ 테이블과 _cars_ 테이블이 있다고 가정할 때, *Saleperson ID*와 *Car ID*는 엔터티의 개별적인 실제 튜플을 고유하게 식별하는 **Primary Key이다**. 이는 _showrooms_ 테이블 내부에서 데이터 세그먼트를 연결하는 **Foreign Key** 역할을 수행한다.

| Salesperson ID | Name |
| -------------- | ---- |
| 1              | Jane |
| 2              | John |

| Car ID | Car Brand |
| ------ | --------- |
| C1     | XYZ       |
| C2     | ABC       |

| Showroom ID | Showroom name | Salesperson ID | Car ID |
| ----------- | ------------- | -------------- | ------ |
| S1          | NY Showroom   | 1              | C1     |

관계형 데이터베이스에서는 **Primary Key와 Foreign Key를 모두** 사용하여 데이터 관계를 정의한다. 위 예시에서는 어떤 쇼룸에 영업사원과 자동차가 존재할 수 있음을 나타낸다.

#### 1-4-4. 엔터티-관계 데이터 모델링

엔터티-관계(Entity-Relationship) 데이터 모델링은 **ER 다이어그램을** 사용하여 데이터베이스 **엔터티와 엔터티 간의 관계를** 나타내는 기법이다. 관계형 데이터 모델링 기법보다 **유연한 특성을** 지니며 주로 데이터 모델링의 **초기 단계에서** 활용된다. 관계형 데이터 모델링 기법이 개발되고 6년 후에 1976년 Peter Chen에 의해 개발되었다.

#### 1-4-5. 객체 지향 데이터 모델링

객제 지향 데이터 모델링은 주로 **객체 지향 프로그래밍 패러다임이 적용된 애플리케이션에** 활용된다. 객체 지향 프로그래밍은 **객체라는 데이터 구조를 활용하여** 데이터를 저장하며, 이 객체는 소프트웨어로 추상화된 실제적 개념이다. 객체 지향 데이터 모델은 관계형 데이터 모델의 한계를 극복하고 멀티미디어 데이터베이스에 널리 사용된다.

객체 지향 데이터 모델에서 자동차 대리점은 이름, 주소 및 전화번호와 같은 속성을 가진 _Customers_ 데이터 객체를 갖는다.

#### 1-4-6. 차원 데이터 모델링: Dimensional

최신 엔터프라이즈 컴퓨팅은 분석에 필요한 대량의 데이터를 **데이터 웨어하우스 기술을** 사용하여 저장한다. 이 데이터 웨어하우스에서 **빠르게 데이터를 저장하고 검색하기 위해** 차원 데이터 모델링 기법을 활용할 수 있다. 차원 데이터 모델링은 **중복 데이터를 허용하며**, 데이터 저장 공간 효율을 높이는 것보다 **성능 효율을 높이는 것에** 방점이 찍혀 있다. 측정 가능한 이벤트들의 수치 데이터를 저장하는 **Fact Table**과 데이터 분석을 위한 다양한 맥락 정보 데이터가 저장되는 **Dimension Table**를 중심으로 구성된다.

자동차 대리점 예시에서는 자동차 대리점에 _Car_, _Showroom_ 및 *Time*과 같은 차원이 있을 수 있다. _Car_ 차원에는 이름과 제조사 같은 속성이 있을 수 있고, _Showroom_ 차원에는 쇼룸명, 주소, 우편 번호 같은 계층이 존재할 수 있다.

## 2. 데이터 디자인

### 2-1. 데이터 디자인이란?

데이터 디자인이란, **데이터베이스의 구조**와 이를 활용하여 어떻게 효율적으로 **데이터를 저장, 검색, 관리**할 것인지에 대한 **계획을 수립하는 과정**을 말한다. 데이터 디자인 단계에는 **효율적인 데이터의 사용과 관리**를 목적으로 앞서 기술된 **개념적, 논리적, 물리적 데이터 모델링**과 **데이터베이스 생성, 데이터 적재** 및 **애플리케이션 연동** 등의 실제 구현이 포함된다. 경우에 따라서는 **데이터베이스 상태 및 성능 모니터링**, **데이터 변경 및 성능 최적화**와 같은 **유지보수 작업도 포함**될 수 있는 단계이다.

### 2-1. 데이터 디자인의 의의

데이터 디자인은 데이터의 **일관성 및 무결성** 유지, **보안성** 및 **성능 향상** 등의 중요한 데이터베이스 관련 요소들을 보장하기 위한 일련의 작업들이 모인 **필수적인** 과정이다. 시스템의 **요구사항과 목표**에 따라 **다양한 형태**로 설계될 수 있으며, 좋은 데이터 디자인은 **효과적인 데이터의 사용과 관리**를 가능하게 한다.
